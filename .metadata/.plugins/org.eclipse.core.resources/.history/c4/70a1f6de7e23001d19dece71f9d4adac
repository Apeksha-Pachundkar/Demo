package com.hms.roommgmtms.controller;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.PutMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RestController;

import com.hms.roommgmtms.model.Room;
import com.hms.roommgmtms.repository.RoomRepository;


@RestController
public class RoomController {

	@Autowired
	private RoomRepository roomRepository;
	

	//Get Hello World from Room MicroService
	
	@GetMapping("/roomhello")
	public String getHello(){ 
		return "Hello World5";
	}

	
	//Add room --Create a new room
	@PostMapping("/room")
	public Room postRoom(@RequestBody Room room)
	{
		return roomRepository.save(room);	
	}
	
	//Get all Rooms--Read 
	@GetMapping("/room")
	public List<Room> getRooms() {
		return roomRepository.findAll();
	}
	

	//delete room by id	--Delete
	@DeleteMapping("/room/{roomId}")		
	public void deleteRoomById(@PathVariable("roomId") Long roomId) {
		roomRepository.deleteById(roomId);
	}
	
	
	//Update room by using roomId --Update
	@PutMapping("/room/update/{roomId}")
	public Room updateRoomDetails(@PathVariable("roomId") Long roomId,@RequestBody Room roomNew)
	{
	    //read room details from db by using roomId
	
		Room roomDB = roomRepository.getById(roomId);
			
		//Checking each value which is going to update whether is NULL or not
		if(roomNew.getRoomType() != null)
			roomDB.setRoomType(roomNew.getRoomType()); // If value is not NULL then update it
		if(roomNew.getCheckIn() != null)
			roomDB.setCheckIn(roomNew.getCheckIn());
		if(roomNew.getCheckOut() != null)
			roomDB.setCheckOut(roomNew.getCheckOut());
		
		//After save updated values in db
		return roomRepository.save(roomDB);
	
	}
	

	//Get Room record by id--Read *****************Use it*********remain to test on postman
    /*	******
	@GetMapping("/room/{roomId}")
	public Room getRoomById(@PathVariable("roomId") Long roomId) {
		return roomRepository.findById(roomId).get();
	}*/

}
